{"version":3,"file":"getTriggerId.js","sources":["src/commands/interactions/slash/getTriggerId.ts"],"sourceRoot":"/","sourcesContent":["import {\n  InteractionContextType,\n  MessageFlags,\n  PermissionFlagsBits,\n  SlashCommandBuilder,\n} from \"discord.js\";\nimport { AppCommand } from \"../../../types/Command\";\nimport {\n  getServerTicketTrigger,\n  getServerTicketTriggers,\n} from \"../../../utils/bot/getServer\";\nimport { onError } from \"../../../utils/onError\";\nimport { t } from \"../../../lang\";\nimport { Locale } from \"../../../types/Locale\";\n\nconst command: AppCommand = {\n  type: \"slash\",\n  data: new SlashCommandBuilder()\n    .setName(\"get_trigger_id\")\n    .setDescription(\"A command to help you get a ticket trigger ID\")\n    .setDefaultMemberPermissions(PermissionFlagsBits.ManageGuild)\n    .setContexts(InteractionContextType.Guild)\n    .setNameLocalizations({})\n    .setDescriptionLocalizations({})\n    .addStringOption((opt) =>\n      opt\n        .setName(\"trigger\")\n        .setDescription(\"Choose a trigger\")\n        .setRequired(true)\n        .setAutocomplete(true)\n    ),\n\n  async autocomplete(client, interaction) {\n    if (!interaction.guildId) return;\n    const focused = interaction.options.getFocused(true).name;\n\n    if (focused === \"trigger\") {\n      const focusedValue = interaction.options.getString(\"trigger\", true);\n      const triggers = await getServerTicketTriggers(interaction.guildId);\n      if (!triggers.length) {\n        interaction.respond([\n          {\n            name: \"You don't have any ticket triggers!\",\n            value: \"\",\n          },\n        ]);\n        return;\n      }\n\n      const filtered = triggers.filter((m) =>\n        m.label.toLowerCase().includes(focusedValue.toLowerCase())\n      );\n\n      interaction.respond(\n        filtered\n          .map((m) => ({\n            name: m.label,\n            value: m._id,\n          }))\n          .slice(0, 25)\n      );\n    }\n  },\n  async execute(client, data, interaction) {\n    if (!interaction.guildId) return;\n\n    const trigger = await getServerTicketTrigger(\n      interaction.options.getString(\"trigger\", true),\n      interaction.guildId\n    );\n    if (!trigger) {\n      const error = (await onError(new Error(\"Trigger not found\"))).discordMsg;\n\n      interaction.reply(error);\n      return;\n    }\n\n    interaction.reply({\n      flags: [MessageFlags.Ephemeral],\n      content: trigger._id,\n    });\n  },\n};\n\nexport default command;\n"],"names":[],"mappings":";;;;AAAA,2CAKoB;AAEpB,4DAGsC;AACtC,oDAAiD;AAIjD,MAAM,OAAO,GAAe;IAC1B,IAAI,EAAE,OAAO;IACb,IAAI,EAAE,IAAI,gCAAmB,EAAE;SAC5B,OAAO,CAAC,gBAAgB,CAAC;SACzB,cAAc,CAAC,+CAA+C,CAAC;SAC/D,2BAA2B,CAAC,gCAAmB,CAAC,WAAW,CAAC;SAC5D,WAAW,CAAC,mCAAsB,CAAC,KAAK,CAAC;SACzC,oBAAoB,CAAC,EAAE,CAAC;SACxB,2BAA2B,CAAC,EAAE,CAAC;SAC/B,eAAe,CAAC,CAAC,GAAG,EAAE,EAAE,CACvB,GAAG;SACA,OAAO,CAAC,SAAS,CAAC;SAClB,cAAc,CAAC,kBAAkB,CAAC;SAClC,WAAW,CAAC,IAAI,CAAC;SACjB,eAAe,CAAC,IAAI,CAAC,CACzB;IAEH,KAAK,CAAC,YAAY,CAAC,MAAM,EAAE,WAAW;QACpC,IAAI,CAAC,WAAW,CAAC,OAAO;YAAE,OAAO;QACjC,MAAM,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC;QAE1D,IAAI,OAAO,KAAK,SAAS,EAAE,CAAC;YAC1B,MAAM,YAAY,GAAG,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YACpE,MAAM,QAAQ,GAAG,MAAM,IAAA,mCAAuB,EAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACpE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;gBACrB,WAAW,CAAC,OAAO,CAAC;oBAClB;wBACE,IAAI,EAAE,qCAAqC;wBAC3C,KAAK,EAAE,EAAE;qBACV;iBACF,CAAC,CAAC;gBACH,OAAO;YACT,CAAC;YAED,MAAM,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CACrC,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAC3D,CAAC;YAEF,WAAW,CAAC,OAAO,CACjB,QAAQ;iBACL,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;gBACX,IAAI,EAAE,CAAC,CAAC,KAAK;gBACb,KAAK,EAAE,CAAC,CAAC,GAAG;aACb,CAAC,CAAC;iBACF,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAChB,CAAC;QACJ,CAAC;IACH,CAAC;IACD,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE,WAAW;QACrC,IAAI,CAAC,WAAW,CAAC,OAAO;YAAE,OAAO;QAEjC,MAAM,OAAO,GAAG,MAAM,IAAA,kCAAsB,EAC1C,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,EAC9C,WAAW,CAAC,OAAO,CACpB,CAAC;QACF,IAAI,CAAC,OAAO,EAAE,CAAC;YACb,MAAM,KAAK,GAAG,CAAC,MAAM,IAAA,iBAAO,EAAC,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;YAEzE,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACzB,OAAO;QACT,CAAC;QAED,WAAW,CAAC,KAAK,CAAC;YAChB,KAAK,EAAE,CAAC,yBAAY,CAAC,SAAS,CAAC;YAC/B,OAAO,EAAE,OAAO,CAAC,GAAG;SACrB,CAAC,CAAC;IACL,CAAC;CACF,CAAC;AAEF,kBAAe,OAAO,CAAC","debug_id":"e4cb58ce-303e-5b88-880b-202aac6fdba7"}