{"version":3,"file":"tags.js","sources":["src/commands/interactions/slash/tags.ts"],"sourceRoot":"/","sourcesContent":["import {\n  GuildMember,\n  InteractionContextType,\n  MessageFlags,\n  PermissionFlagsBits,\n  SlashCommandBuilder,\n} from \"discord.js\";\nimport { AppCommand } from \"../../../types/Command\";\nimport {\n  getServerGroups,\n  getServerMessage,\n  getServerMessages,\n  getServerTag,\n  getServerTags,\n} from \"../../../utils/bot/getServer\";\nimport { t } from \"../../../lang\";\nimport { getUserPermissions } from \"../../../utils/calculateUserPermissions\";\nimport { onError } from \"../../../utils/onError\";\nimport limits from \"../../../constants/limits\";\nimport { generateId } from \"../../../utils/database/generateId\";\nimport { TagSchema } from \"../../../database/modals/Tag\";\nimport { invalidateCache } from \"../../../utils/database/invalidateCache\";\nimport { updateCachedData } from \"../../../utils/database/updateCache\";\nimport { toTimeUnit } from \"../../../utils/formatters/toTimeUnit\";\nimport serverMessageToDiscordMessage from \"../../../utils/formatters/serverMessageToDiscordMessage\";\n\nconst cmd: AppCommand = {\n  type: \"slash\",\n  data: new SlashCommandBuilder()\n    .setName(\"tags\")\n    .setDescription(\"Tag configuration base\")\n    .setDefaultMemberPermissions(PermissionFlagsBits.ManageMessages)\n    .setContexts(InteractionContextType.Guild)\n    .addSubcommand((cmd) =>\n      cmd\n        .setName(\"view\")\n        .setDescription(\"View a tag\")\n        .addStringOption((opt) =>\n          opt\n            .setName(\"tag\")\n            .setDescription(\"Select a tag\")\n            .setAutocomplete(true)\n            .setRequired(true)\n        )\n    )\n    .addSubcommand((cmd) =>\n      cmd\n        .setName(\"new\")\n        .setDescription(\"Create a new tag\")\n        .addStringOption((opt) =>\n          opt\n            .setName(\"name\")\n            .setDescription(\"The name of this tag\")\n            .setRequired(true)\n            .setMaxLength(100)\n            .setMinLength(2)\n        )\n        .addStringOption((opt) =>\n          opt\n            .setName(\"message\")\n            .setDescription(\"The new message of the tag\")\n            .setAutocomplete(true)\n            .setRequired(true)\n        )\n    )\n    .addSubcommand((cmd) =>\n      cmd\n        .setName(\"delete\")\n        .setDescription(\"Delete a tag\")\n        .addStringOption((opt) =>\n          opt\n            .setName(\"tag\")\n            .setDescription(\"The name of the tag to edit\")\n            .setAutocomplete(true)\n            .setRequired(true)\n        )\n    )\n    .addSubcommand((cmd) =>\n      cmd\n        .setName(\"edit\")\n        .setDescription(\"Create a new tag\")\n        .addStringOption((opt) =>\n          opt\n            .setName(\"tag\")\n            .setDescription(\"The name of the tag to edit\")\n            .setAutocomplete(true)\n            .setRequired(true)\n        )\n        .addStringOption((opt) =>\n          opt\n            .setName(\"name\")\n            .setDescription(\"The new name of the tag\")\n            .setMaxLength(100)\n            .setMinLength(2)\n        )\n        .addStringOption((opt) =>\n          opt\n            .setName(\"message\")\n            .setDescription(\"The new message of the tag\")\n            .setAutocomplete(true)\n        )\n    ),\n  async autocomplete(client, interaction) {\n    if (!interaction.guildId) return;\n    const focused = interaction.options.getFocused(true).name;\n    if (focused === \"tag\") {\n      const focusedValue = interaction.options.getString(\"tag\", true);\n      const tags = await getServerTags(interaction.guildId);\n      if (!tags.length) {\n        interaction.respond([\n          {\n            name: \"You don't have any tags!\",\n            value: \"\",\n          },\n        ]);\n        return;\n      }\n\n      const filtered = tags.filter((m) =>\n        m.name.toLowerCase().includes(focusedValue.toLowerCase())\n      );\n\n      interaction.respond(\n        filtered\n          .map((m) => ({\n            name: m.name,\n            value: m._id,\n          }))\n          .slice(0, 25)\n      );\n    } else if (focused === \"message\") {\n      const focusedValue = interaction.options.getString(\"message\", true);\n      const message = await getServerMessages(interaction.guildId);\n      if (!message.length) {\n        interaction.respond([\n          {\n            name: \"You don't have any message!\",\n            value: \"\",\n          },\n        ]);\n        return;\n      }\n\n      const filtered = message.filter((m) =>\n        m.name.toLowerCase().includes(focusedValue.toLowerCase())\n      );\n\n      interaction.respond(\n        filtered\n          .map((m) => ({\n            name: m.name,\n            value: m._id,\n          }))\n          .slice(0, 25)\n      );\n    }\n  },\n  async execute(client, data, interaction) {\n    if (!interaction.guildId) return;\n    const subcommand = interaction.options.getSubcommand(true);\n    const lang = data.lang!;\n\n    await interaction.reply({\n      content: t(data.lang!, \"THINK\"),\n      flags: [MessageFlags.Ephemeral],\n    });\n\n    const groups = await getServerGroups(interaction.guildId);\n    const userPermissions = getUserPermissions(\n      interaction.member as GuildMember,\n      groups\n    );\n\n    if (subcommand === \"new\") {\n      if (\n        !userPermissions.tags.create &&\n        !interaction.memberPermissions?.has(PermissionFlagsBits.ManageGuild)\n      )\n        return interaction.editReply(\n          (await onError(new Error(\"Missing create permission\"))).discordMsg\n        );\n\n      const tags = await getServerTags(interaction.guildId);\n      if (tags.length >= limits.free.tags.amount)\n        return interaction.editReply(\n          (await onError(new Error(\"Tag limit reached\"))).discordMsg\n        );\n\n      const id = generateId(\"GT\");\n      const name = interaction.options.getString(\"name\", true);\n      const messageId = interaction.options.getString(\"message\", true);\n      const message = await getServerMessage(messageId, interaction.guildId);\n\n      if (!message)\n        return interaction.editReply(\n          (await onError(new Error(\"Message not found\"))).discordMsg\n        );\n\n      const tag = await TagSchema.create({\n        _id: id,\n        name: name,\n        server: interaction.guildId,\n        message: messageId,\n      });\n\n      interaction.editReply({\n        content: t(lang, \"TAG_CREATED\"),\n      });\n      await invalidateCache(`tags:${interaction.guildId}`);\n      updateCachedData(\n        `tag:${id}`,\n        toTimeUnit(\"seconds\", 0, 10),\n        tag.toObject()\n      );\n    } else if (subcommand === \"view\") {\n      if (\n        (!userPermissions.tags.create ||\n          !userPermissions.tags.edit ||\n          !userPermissions.tags.delete) &&\n        !interaction.memberPermissions?.has(PermissionFlagsBits.ManageGuild)\n      )\n        return interaction.editReply(\n          (await onError(new Error(\"Missing view permission\"))).discordMsg\n        );\n      const tagId = interaction.options.getString(\"tag\", true);\n      const tag = await getServerTag(tagId, interaction.guildId);\n      if (!tag)\n        return interaction.editReply(\n          (await onError(new Error(\"Tag not found\"))).discordMsg\n        );\n\n      const message = await getServerMessage(tag.message, interaction.guildId);\n      if (!message)\n        return interaction.editReply(\n          (await onError(new Error(\"Tag message not found\"))).discordMsg\n        );\n\n      interaction.editReply({\n        ...serverMessageToDiscordMessage(message),\n      });\n    } else if (subcommand === \"edit\") {\n      if (\n        !userPermissions.tags.edit &&\n        !interaction.memberPermissions?.has(PermissionFlagsBits.ManageGuild)\n      )\n        return interaction.editReply(\n          (await onError(new Error(\"Missing edit permission\"))).discordMsg\n        );\n      const tagId = interaction.options.getString(\"tag\", true);\n      const name = interaction.options.getString(\"name\");\n      const messageId = interaction.options.getString(\"message\");\n      if (!name && !messageId)\n        return interaction.editReply(\n          (await onError(new Error(\"Invalid usage\"))).discordMsg\n        );\n\n      const tag = await getServerTag(tagId, interaction.guildId);\n      if (!tag)\n        return interaction.editReply(\n          (await onError(new Error(\"Tag not found\"))).discordMsg\n        );\n\n      const message = await getServerMessage(\n        messageId || tag.message,\n        interaction.guildId\n      );\n      if (!message)\n        return interaction.editReply(\n          (await onError(new Error(\"Message not found\"))).discordMsg\n        );\n\n      interaction.editReply({\n        content: t(lang, \"TAG_UPDATED\"),\n      });\n      await TagSchema.findOneAndUpdate(\n        {\n          _id: tagId,\n        },\n        {\n          name: interaction.options.getString(\"name\") || tag.name,\n          message: message._id,\n        }\n      );\n\n      await invalidateCache(`tags:${interaction.guildId}`);\n      // We don't need to worry about invalidating the individual tag cache as this is only used for the message\n    } else if (subcommand === \"delete\") {\n      if (\n        !userPermissions.tags.delete &&\n        !interaction.memberPermissions?.has(PermissionFlagsBits.ManageGuild)\n      )\n        return interaction.editReply(\n          (await onError(new Error(\"Missing delete permission\"))).discordMsg\n        );\n      const tagId = interaction.options.getString(\"tag\", true);\n      const tag = await getServerTag(tagId, interaction.guildId);\n      if (!tag)\n        return interaction.editReply(\n          (await onError(new Error(\"Tag not found\"))).discordMsg\n        );\n\n      await TagSchema.findOneAndDelete({ _id: tagId });\n      await invalidateCache(`tags:${interaction.guildId}`);\n      await invalidateCache(`tag:${tagId}`);\n\n      interaction.editReply({\n        content: t(lang, \"TAG_DELETED\"),\n      });\n    }\n  },\n};\n\nexport default cmd;\n"],"names":[],"mappings":"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","debug_id":"3a197464-778a-570f-9704-546b0c28d271"}