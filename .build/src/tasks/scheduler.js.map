{"version":3,"file":"scheduler.js","sources":["src/tasks/scheduler.ts"],"sourceRoot":"/","sourcesContent":["import cron from \"node-cron\";\r\nimport { Client } from \"discord.js\";\r\nimport logger from \"../utils/logger\";\r\n\r\ntype Task = {\r\n  name: string;\r\n  schedule?: string; // e.g., '*/5 * * * *'\r\n  intervalMs?: number;\r\n  run: (client: Client) => Promise<void> | void;\r\n};\r\n\r\nconst tasks: Task[] = [];\r\n\r\nexport const registerTask = (task: Task) => tasks.push(task);\r\n\r\nexport const startTasks = (client: Client) => {\r\n  for (const task of tasks) {\r\n    if (task.schedule) {\r\n      cron.schedule(task.schedule, () => task.run(client));\r\n      logger.info(`Task ${task.name} set to run on schedule ${task.schedule}`);\r\n    } else if (task.intervalMs) {\r\n      setInterval(() => task.run(client), task.intervalMs);\r\n      logger.info(`Task ${task.name} set to run every ${task.intervalMs}ms`);\r\n    }\r\n  }\r\n};\r\n"],"names":[],"mappings":";;;;;;;;AAAA,0DAA6B;AAE7B,6DAAqC;AASrC,MAAM,KAAK,GAAW,EAAE,CAAC;AAElB,MAAM,YAAY,GAAG,CAAC,IAAU,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAAhD,QAAA,YAAY,gBAAoC;AAEtD,MAAM,UAAU,GAAG,CAAC,MAAc,EAAE,EAAE;IAC3C,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;QACzB,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAClB,mBAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;YACrD,gBAAM,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,2BAA2B,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC3E,CAAC;aAAM,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YAC3B,WAAW,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YACrD,gBAAM,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,qBAAqB,IAAI,CAAC,UAAU,IAAI,CAAC,CAAC;QACzE,CAAC;IACH,CAAC;AACH,CAAC,CAAC;AAVW,QAAA,UAAU,cAUrB","debug_id":"3551fa49-c1e1-5733-be24-87b26fc86459"}