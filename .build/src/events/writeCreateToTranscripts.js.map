{"version":3,"file":"writeCreateToTranscripts.js","sources":["src/events/writeCreateToTranscripts.ts"],"sourceRoot":"/","sourcesContent":["import { Event } from \"../types/Event\";\nimport { TicketChannelManager } from \"../utils/bot/TicketChannelManager\";\nimport { transcriptWriterManager } from \"../utils/tickets/TranscriptManager\";\n\nconst event: Event<\"messageCreate\"> = {\n  name: \"messageCreate\",\n  async execute(client, data, message) {\n    if (!message.guildId) return;\n    if (message.flags.has(\"Ephemeral\")) return;\n\n    const ticket = await new TicketChannelManager().getTicket(\n      message.channelId\n    );\n    if (!ticket?.takeTranscript) return;\n\n    const writer = transcriptWriterManager.get(\n      ticket.ticketId,\n      ticket.anonymise\n    );\n    writer.appendMessage(message);\n\n    if (message.mentions.channels) {\n      for (const channel of message.mentions.channels.values()) {\n        writer.setMeta(\n          `channels.${channel.id}`,\n          \"name\" in channel ? channel.name : \"Unknown Channel\"\n        );\n      }\n    }\n    if (message.mentions.users) {\n      for (const user of message.mentions.users.values()) {\n        writer.setMeta(`users.${user.id}`, user.username);\n      }\n    }\n    if (message.mentions.roles) {\n      for (const role of message.mentions.roles.values()) {\n        writer.setMeta(`roles.${role.id}`, role.name);\n      }\n    }\n  },\n};\n\nexport default event;\n"],"names":[],"mappings":";;;;AACA,4EAAyE;AACzE,0EAA6E;AAE7E,MAAM,KAAK,GAA2B;IACpC,IAAI,EAAE,eAAe;IACrB,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO;QACjC,IAAI,CAAC,OAAO,CAAC,OAAO;YAAE,OAAO;QAC7B,IAAI,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC;YAAE,OAAO;QAE3C,MAAM,MAAM,GAAG,MAAM,IAAI,2CAAoB,EAAE,CAAC,SAAS,CACvD,OAAO,CAAC,SAAS,CAClB,CAAC;QACF,IAAI,CAAC,MAAM,EAAE,cAAc;YAAE,OAAO;QAEpC,MAAM,MAAM,GAAG,2CAAuB,CAAC,GAAG,CACxC,MAAM,CAAC,QAAQ,EACf,MAAM,CAAC,SAAS,CACjB,CAAC;QACF,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAE9B,IAAI,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;YAC9B,KAAK,MAAM,OAAO,IAAI,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC;gBACzD,MAAM,CAAC,OAAO,CACZ,YAAY,OAAO,CAAC,EAAE,EAAE,EACxB,MAAM,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,iBAAiB,CACrD,CAAC;YACJ,CAAC;QACH,CAAC;QACD,IAAI,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;YAC3B,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC;gBACnD,MAAM,CAAC,OAAO,CAAC,SAAS,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YACpD,CAAC;QACH,CAAC;QACD,IAAI,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;YAC3B,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC;gBACnD,MAAM,CAAC,OAAO,CAAC,SAAS,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YAChD,CAAC;QACH,CAAC;IACH,CAAC;CACF,CAAC;AAEF,kBAAe,KAAK,CAAC","debug_id":"da2fe566-f4b0-5286-a541-a2d44944db07"}