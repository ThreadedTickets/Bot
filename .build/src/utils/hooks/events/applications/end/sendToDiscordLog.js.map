{"version":3,"file":"sendToDiscordLog.js","sources":["src/utils/hooks/events/applications/end/sendToDiscordLog.ts"],"sourceRoot":"/","sourcesContent":["import { Client } from \"discord.js\";\nimport { registerHook } from \"../../..\";\nimport {\n  Application,\n  ApplicationQuestion,\n} from \"../../../../../types/Application\";\nimport { getServer } from \"../../../../bot/getServer\";\nimport {\n  getAvailableLogChannel,\n  postLogToWebhook,\n} from \"../../../../bot/sendLogToWebhook\";\nimport colours from \"../../../../../constants/colours\";\nimport { t } from \"../../../../../lang\";\n\nregisterHook(\n  \"ApplicationEnd\",\n  async ({\n    client,\n    application,\n    responses,\n    owner,\n  }: {\n    client: Client;\n    application: Application;\n    responses: {\n      applicationId: string;\n      startTime: Date;\n      server: string;\n      questionNumber: number;\n      questions: ApplicationQuestion[];\n\n      responses: { question: string; response: string }[];\n    };\n    owner: string;\n  }) => {\n    const server = await getServer(application.server);\n    const logChannel = getAvailableLogChannel(\n      server.settings.logging,\n      \"applications.create\"\n    );\n    if (!logChannel) return;\n\n    await postLogToWebhook(\n      client,\n      {\n        channel: logChannel.channel!,\n        enabled: logChannel.enabled,\n        webhook: logChannel.webhook!,\n      },\n      {\n        embeds: [\n          {\n            color: parseInt(colours.info, 16),\n            title: t(server.preferredLanguage, \"NEW_APPLICATION_LOG_TITLE\"),\n            description: t(\n              server.preferredLanguage,\n              `NEW_APPLICATION_LOG_BODY`,\n              {\n                user: `<@${owner}>`,\n                application: application.name,\n              }\n            ),\n          },\n        ],\n      }\n    );\n  }\n);\n"],"names":[],"mappings":";;;;;;;AACA,gCAAwC;AAKxC,yDAAsD;AACtD,uEAG0C;AAC1C,+EAAuD;AACvD,8CAAwC;AAExC,IAAA,gBAAY,EACV,gBAAgB,EAChB,KAAK,EAAE,EACL,MAAM,EACN,WAAW,EACX,SAAS,EACT,KAAK,GAcN,EAAE,EAAE;IACH,MAAM,MAAM,GAAG,MAAM,IAAA,qBAAS,EAAC,WAAW,CAAC,MAAM,CAAC,CAAC;IACnD,MAAM,UAAU,GAAG,IAAA,yCAAsB,EACvC,MAAM,CAAC,QAAQ,CAAC,OAAO,EACvB,qBAAqB,CACtB,CAAC;IACF,IAAI,CAAC,UAAU;QAAE,OAAO;IAExB,MAAM,IAAA,mCAAgB,EACpB,MAAM,EACN;QACE,OAAO,EAAE,UAAU,CAAC,OAAQ;QAC5B,OAAO,EAAE,UAAU,CAAC,OAAO;QAC3B,OAAO,EAAE,UAAU,CAAC,OAAQ;KAC7B,EACD;QACE,MAAM,EAAE;YACN;gBACE,KAAK,EAAE,QAAQ,CAAC,iBAAO,CAAC,IAAI,EAAE,EAAE,CAAC;gBACjC,KAAK,EAAE,IAAA,QAAC,EAAC,MAAM,CAAC,iBAAiB,EAAE,2BAA2B,CAAC;gBAC/D,WAAW,EAAE,IAAA,QAAC,EACZ,MAAM,CAAC,iBAAiB,EACxB,0BAA0B,EAC1B;oBACE,IAAI,EAAE,KAAK,KAAK,GAAG;oBACnB,WAAW,EAAE,WAAW,CAAC,IAAI;iBAC9B,CACF;aACF;SACF;KACF,CACF,CAAC;AACJ,CAAC,CACF,CAAC","debug_id":"3c9e0376-2c27-5715-8dbd-28e497b2d83c"}