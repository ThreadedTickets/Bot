{"version":3,"file":"serverMessageToDiscordMessage.js","sources":["src/utils/formatters/serverMessageToDiscordMessage.ts"],"sourceRoot":"/","sourcesContent":["import { APIEmbed } from \"discord.js\";\n\nexport default function serverMessageToDiscordMessage(serverMessage: {\n  name: string;\n  content: string;\n  embeds?: {\n    title?: string;\n    description?: string;\n    color?: string;\n    fields?: { name: string; value: string; inline?: boolean }[];\n    author?: { name?: string; url?: string; icon_url?: string };\n    footer?: { text?: string; icon_url?: string };\n    thumbnail?: { url: string };\n    image?: { url: string };\n    timestamp?: boolean | Date;\n  }[];\n  components: any[];\n  attachments: { name: string; base64: string }[];\n}) {\n  const returnValue: {\n    content?: string;\n    files?: { name: string; attachment: Buffer }[];\n    embeds?: APIEmbed[];\n    components?: any[];\n  } = {};\n\n  returnValue.content = serverMessage.content;\n\n  if (serverMessage.embeds?.length) {\n    returnValue.embeds = [];\n\n    for (const embed of serverMessage.embeds) {\n      const emb: APIEmbed = {};\n\n      if (embed.title) emb.title = embed.title;\n      if (embed.description) emb.description = embed.description;\n      if (embed.color) {\n        try {\n          emb.color = parseInt(embed.color.replace(\"#\", \"\"), 16);\n        } catch {}\n      }\n\n      if (embed.fields?.length) emb.fields = embed.fields;\n\n      if (embed.author?.name) {\n        emb.author = {\n          name: embed.author.name,\n          url: embed.author.url || undefined,\n          icon_url: embed.author.icon_url || undefined,\n        };\n      }\n\n      if (embed.footer?.text) {\n        emb.footer = {\n          text: embed.footer.text,\n          icon_url: embed.footer.icon_url || undefined,\n        };\n      }\n\n      if (embed.thumbnail?.url) {\n        emb.thumbnail = { url: embed.thumbnail.url };\n      }\n\n      if (embed.image?.url) {\n        emb.image = { url: embed.image.url };\n      }\n\n      if (embed.timestamp) {\n        emb.timestamp =\n          embed.timestamp === true\n            ? new Date().toISOString()\n            : new Date(embed.timestamp).toISOString();\n      }\n\n      returnValue.embeds.push(emb);\n    }\n  }\n\n  if (serverMessage.components?.length) {\n    returnValue.components = serverMessage.components;\n  }\n\n  //! This is disabled for now as it will probably become a paid feature\n  // if (serverMessage.attachments?.length) {\n  //   returnValue.files = serverMessage.attachments.map((att) => ({\n  //     name: att.name,\n  //     attachment: Buffer.from(att.base64, \"base64\"),\n  //   }));\n  // }\n\n  return returnValue;\n}\n"],"names":[],"mappings":";;;;AAEA,gDAyFC;AAzFD,SAAwB,6BAA6B,CAAC,aAgBrD;IACC,MAAM,WAAW,GAKb,EAAE,CAAC;IAEP,WAAW,CAAC,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC;IAE5C,IAAI,aAAa,CAAC,MAAM,EAAE,MAAM,EAAE,CAAC;QACjC,WAAW,CAAC,MAAM,GAAG,EAAE,CAAC;QAExB,KAAK,MAAM,KAAK,IAAI,aAAa,CAAC,MAAM,EAAE,CAAC;YACzC,MAAM,GAAG,GAAa,EAAE,CAAC;YAEzB,IAAI,KAAK,CAAC,KAAK;gBAAE,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;YACzC,IAAI,KAAK,CAAC,WAAW;gBAAE,GAAG,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;YAC3D,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;gBAChB,IAAI,CAAC;oBACH,GAAG,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;gBACzD,CAAC;gBAAC,MAAM,CAAC,CAAA,CAAC;YACZ,CAAC;YAED,IAAI,KAAK,CAAC,MAAM,EAAE,MAAM;gBAAE,GAAG,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;YAEpD,IAAI,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC;gBACvB,GAAG,CAAC,MAAM,GAAG;oBACX,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI;oBACvB,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,GAAG,IAAI,SAAS;oBAClC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,QAAQ,IAAI,SAAS;iBAC7C,CAAC;YACJ,CAAC;YAED,IAAI,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC;gBACvB,GAAG,CAAC,MAAM,GAAG;oBACX,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI;oBACvB,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,QAAQ,IAAI,SAAS;iBAC7C,CAAC;YACJ,CAAC;YAED,IAAI,KAAK,CAAC,SAAS,EAAE,GAAG,EAAE,CAAC;gBACzB,GAAG,CAAC,SAAS,GAAG,EAAE,GAAG,EAAE,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;YAC/C,CAAC;YAED,IAAI,KAAK,CAAC,KAAK,EAAE,GAAG,EAAE,CAAC;gBACrB,GAAG,CAAC,KAAK,GAAG,EAAE,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;YACvC,CAAC;YAED,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC;gBACpB,GAAG,CAAC,SAAS;oBACX,KAAK,CAAC,SAAS,KAAK,IAAI;wBACtB,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;wBAC1B,CAAC,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,WAAW,EAAE,CAAC;YAChD,CAAC;YAED,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC/B,CAAC;IACH,CAAC;IAED,IAAI,aAAa,CAAC,UAAU,EAAE,MAAM,EAAE,CAAC;QACrC,WAAW,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,CAAC;IACpD,CAAC;IAED,sEAAsE;IACtE,2CAA2C;IAC3C,kEAAkE;IAClE,sBAAsB;IACtB,qDAAqD;IACrD,SAAS;IACT,IAAI;IAEJ,OAAO,WAAW,CAAC;AACrB,CAAC","debug_id":"8c090617-4716-5b5e-b7e9-50dd7cd4e729"}