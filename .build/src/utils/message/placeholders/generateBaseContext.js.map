{"version":3,"file":"generateBaseContext.js","sources":["src/utils/message/placeholders/generateBaseContext.ts"],"sourceRoot":"/","sourcesContent":["import { Channel, Guild, GuildMember, User } from \"discord.js\";\n\nexport function generateBasePlaceholderContext(options: {\n  server: Guild;\n  user?: User;\n  member?: GuildMember | null;\n  channel?: Channel;\n}) {\n  const { server, user, member, channel } = options;\n  const context: {\n    server?: {\n      id: string;\n      name: string;\n      members: number;\n      boosts: number;\n    };\n    user?: {\n      id: string;\n      username: string;\n      displayname: string;\n      avatar: string;\n    };\n    member?: {\n      roles: {\n        flat: string;\n        mentions: string;\n        ids: string;\n        names: string;\n        highest: {\n          id: string;\n          name: string;\n          flat: string;\n          mention: string;\n        };\n      };\n      nickname: string;\n    };\n    channel?: {\n      id: string;\n      name: string;\n    };\n  } = {};\n\n  if (options.server)\n    context[\"server\"] = {\n      id: server.id,\n      name: server.name,\n      boosts: server.premiumSubscriptionCount || 0,\n      members: server.memberCount,\n    };\n  if (options.user)\n    context[\"user\"] = {\n      id: user!.id,\n      displayname: user!.displayName,\n      avatar: user!.avatarURL() || \"\",\n      username: user!.username,\n    };\n  if (options.channel)\n    context[\"channel\"] = {\n      id: channel!.id,\n      name: \"name\" in channel! ? channel.name! : \"\",\n    };\n  if (options.member) {\n    const roles = member!.roles.cache\n      .filter((role) => role.id !== server.id)\n      .map((role) => ({\n        id: role.id,\n        name: role.name,\n      }));\n\n    const highestRole = member!.roles.highest;\n    /**\n     * .replace(new RegExp(/([*_~])/g), \"\\\\$1\")\n     * can make it suit discord formatting\n     */\n    context[\"member\"] = {\n      nickname: member!.nickname || user!.displayName,\n      roles: {\n        flat: roles.map((r) => `@${r.name}`).join(\", \"),\n        names: roles.map((r) => r.name).join(\", \"),\n        mentions: roles.map((r) => `<@&${r.id}>`).join(\", \"),\n        ids: roles.map((r) => r.id).join(\", \"),\n        highest: {\n          flat: `@${highestRole.name}`,\n          id: highestRole.id,\n          name: highestRole.name,\n          mention: `<@&${highestRole.id}>`,\n        },\n      },\n    };\n  }\n\n  return context;\n}\n"],"names":[],"mappings":";;;;AAEA,wEA2FC;AA3FD,SAAgB,8BAA8B,CAAC,OAK9C;IACC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC;IAClD,MAAM,OAAO,GAgCT,EAAE,CAAC;IAEP,IAAI,OAAO,CAAC,MAAM;QAChB,OAAO,CAAC,QAAQ,CAAC,GAAG;YAClB,EAAE,EAAE,MAAM,CAAC,EAAE;YACb,IAAI,EAAE,MAAM,CAAC,IAAI;YACjB,MAAM,EAAE,MAAM,CAAC,wBAAwB,IAAI,CAAC;YAC5C,OAAO,EAAE,MAAM,CAAC,WAAW;SAC5B,CAAC;IACJ,IAAI,OAAO,CAAC,IAAI;QACd,OAAO,CAAC,MAAM,CAAC,GAAG;YAChB,EAAE,EAAE,IAAK,CAAC,EAAE;YACZ,WAAW,EAAE,IAAK,CAAC,WAAW;YAC9B,MAAM,EAAE,IAAK,CAAC,SAAS,EAAE,IAAI,EAAE;YAC/B,QAAQ,EAAE,IAAK,CAAC,QAAQ;SACzB,CAAC;IACJ,IAAI,OAAO,CAAC,OAAO;QACjB,OAAO,CAAC,SAAS,CAAC,GAAG;YACnB,EAAE,EAAE,OAAQ,CAAC,EAAE;YACf,IAAI,EAAE,MAAM,IAAI,OAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,IAAK,CAAC,CAAC,CAAC,EAAE;SAC9C,CAAC;IACJ,IAAI,OAAO,CAAC,MAAM,EAAE,CAAC;QACnB,MAAM,KAAK,GAAG,MAAO,CAAC,KAAK,CAAC,KAAK;aAC9B,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC;aACvC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YACd,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,IAAI,EAAE,IAAI,CAAC,IAAI;SAChB,CAAC,CAAC,CAAC;QAEN,MAAM,WAAW,GAAG,MAAO,CAAC,KAAK,CAAC,OAAO,CAAC;QAC1C;;;WAGG;QACH,OAAO,CAAC,QAAQ,CAAC,GAAG;YAClB,QAAQ,EAAE,MAAO,CAAC,QAAQ,IAAI,IAAK,CAAC,WAAW;YAC/C,KAAK,EAAE;gBACL,IAAI,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBAC/C,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBAC1C,QAAQ,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBACpD,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBACtC,OAAO,EAAE;oBACP,IAAI,EAAE,IAAI,WAAW,CAAC,IAAI,EAAE;oBAC5B,EAAE,EAAE,WAAW,CAAC,EAAE;oBAClB,IAAI,EAAE,WAAW,CAAC,IAAI;oBACtB,OAAO,EAAE,MAAM,WAAW,CAAC,EAAE,GAAG;iBACjC;aACF;SACF,CAAC;IACJ,CAAC;IAED,OAAO,OAAO,CAAC;AACjB,CAAC","debug_id":"9b186718-3513-58ce-9feb-1a5e000fbd8c"}